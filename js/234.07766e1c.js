"use strict";(self["webpackChunkcosmos_telegram_signer"]=self["webpackChunkcosmos_telegram_signer"]||[]).push([[234],{1609:function(e,t,n){n.d(t,{ys:function(){return V},bQ:function(){return R}});n(4979);const a=(e,t)=>t.some((t=>e instanceof t));let s,i;function o(){return s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function l(){return i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const r=new WeakMap,c=new WeakMap,u=new WeakMap;function d(e){const t=new Promise(((t,n)=>{const a=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(f(e.result)),a()},i=()=>{n(e.error),a()};e.addEventListener("success",s),e.addEventListener("error",i)}));return u.set(t,e),t}function p(e){if(r.has(e))return;const t=new Promise(((t,n)=>{const a=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),a()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)}));r.set(e,t)}let v={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return r.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function b(e){v=e(v)}function g(e){return l().includes(e)?function(...t){return e.apply(k(this),t),f(this.request)}:function(...t){return f(e.apply(k(this),t))}}function m(e){return"function"===typeof e?g(e):(e instanceof IDBTransaction&&p(e),a(e,o())?new Proxy(e,v):e)}function f(e){if(e instanceof IDBRequest)return d(e);if(c.has(e))return c.get(e);const t=m(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const k=e=>u.get(e);function w(e,t,{blocked:n,upgrade:a,blocking:s,terminated:i}={}){const o=indexedDB.open(e,t),l=f(o);return a&&o.addEventListener("upgradeneeded",(e=>{a(f(o.result),e.oldVersion,e.newVersion,f(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),l.then((e=>{i&&e.addEventListener("close",(()=>i())),s&&e.addEventListener("versionchange",(e=>s(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),l}const h=["get","getKey","getAll","getAllKeys","count"],L=["put","add","delete","clear"],_=new Map;function y(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(_.get(t))return _.get(t);const n=t.replace(/FromIndex$/,""),a=t!==n,s=L.includes(n);if(!(n in(a?IDBIndex:IDBObjectStore).prototype)||!s&&!h.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,s?"readwrite":"readonly");let o=i.store;return a&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),s&&i.done]))[0]};return _.set(t,i),i}b((e=>({...e,get:(t,n,a)=>y(t,n)||e.get(t,n,a),has:(t,n)=>!!y(t,n)||e.has(t,n)})));const I=["continue","continuePrimaryKey","advance"],B={},D=new WeakMap,j=new WeakMap,x={get(e,t){if(!I.includes(t))return e[t];let n=B[t];return n||(n=B[t]=function(...e){D.set(this,j.get(this)[t](...e))}),n}};async function*K(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,x);j.set(n,t),u.set(n,k(t));while(t)yield n,t=await(D.get(n)||t.continue()),D.delete(n)}function E(e,t){return t===Symbol.asyncIterator&&a(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&a(e,[IDBIndex,IDBObjectStore])}b((e=>({...e,get(t,n,a){return E(t,n)?K:e.get(t,n,a)},has(t,n){return E(t,n)||e.has(t,n)}})));const C=w("bro_db",1,{upgrade(e){e.objectStoreNames.contains("wallet")||e.createObjectStore("wallet")}});async function R(e,t){let n=await C;return n.get(e,t)}async function V(e,t){let n=await C,a=n.transaction(e,"readwrite"),s=a.objectStore(e);for(let[i,o]of t)await s.put(o,i);await a.done}},8374:function(e,t,n){n.r(t),n.d(t,{default:function(){return G}});n(4114);var a=n(6768),s=n(4232),i=n(5130),o=n(4113),l=n(144),r=n(1387),c=n(1981),u=n(1609),d=n(9114);const p=e=>((0,a.Qi)("data-v-16c899dc"),e=e(),(0,a.jt)(),e),v=o+"#ic_arrow_hor",b=o+"#ic_biometric",g={class:"page_container careate_pin_page"},m={class:"cont"},f={class:"page_title"},k={class:"page_data_wrap"},w={class:"page_data"},h=p((()=>(0,a.Lk)("svg",{class:"icon"},[(0,a.Lk)("use",{"xlink:href":v})],-1))),L={class:"wallet_name"},_={class:"label"},y={class:"field"},I=["placeholder"],B={class:"create_pin"},D={class:"label"},j={class:"row"},x={class:"field"},K={class:"field"},E=["disabled"],C={class:"field"},R=["disabled"],V={class:"field"},A=["disabled"],S={class:"confirm_pin"},W={class:"label"},$={class:"field"},M=["disabled"],J={class:"field"},P=["disabled"],T={class:"field"},U=["disabled"],O={class:"field"},q=["disabled"],F=p((()=>(0,a.Lk)("svg",{class:"icon"},[(0,a.Lk)("use",{"xlink:href":b})],-1))),N={class:"btns"};var Q={__name:"CreatePinPage",setup(e){const t=(0,r.rd)(),n=(0,l.KR)(!0),o=(0,l.KR)(""),p=(0,l.KR)(!1),v=(0,l.KR)(!1),b=(0,l.KR)(["","","",""]),Q=(0,l.KR)(["","","",""]);function X(){o.value.trim().length?p.value=!0:p.value=!1,v.value=!0}function z(e,t){e.target.value.length>=1&&t<4&&e.target.closest(".row").querySelector(`.field:nth-child(${t+1}) input`).focus()}function G(e,t){setTimeout((()=>{0===e.target.value.length&&t>0&&e.target.closest(".row").querySelector(`.field:nth-child(${t}) input`).select()}))}(0,a.KC)((()=>{n.value=!1}));const H=(0,a.EW)((()=>b.value.join("")===Q.value.join(""))),Y=(0,a.EW)((()=>""!==Q.value[3].length&&H.value&&p.value));async function Z(){if(Telegram.WebApp.BiometricManager.isInited||await Telegram.WebApp.BiometricManager.init(),await Telegram.WebApp.BiometricManager.isBiometricAvailable()){let e=await Telegram.WebApp.BiometricManager.authenticate();e?(console.log("Biometric authentication successful:",e),alert("Authentication successful!")):alert("Authentication failed.")}}async function ee(){let e=await(0,c.Q1)();await(0,u.ys)("wallet",[["hmacKey",e],["pin",await(0,c.mK)(b.value.join(""),e)],["name",o.value]]),t.push("/wallet_created")}return(e,t)=>{const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("section",g,[(0,a.Lk)("div",m,[(0,a.Lk)("div",f,(0,s.v_)(e.$t("message.create_pin_title")),1),(0,a.Lk)("div",k,[(0,a.Lk)("div",w,[n.value?((0,a.uX)(),(0,a.Wv)(d.A,{key:0})):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(l,{class:"back_btn",to:"/create_wallet"},{default:(0,a.k6)((()=>[h])),_:1}),(0,a.Lk)("div",L,[(0,a.Lk)("div",_,(0,s.v_)(e.$t("message.create_pin_wallet_name_label")),1),(0,a.Lk)("div",y,[(0,a.bo)((0,a.Lk)("input",{type:"text",class:(0,s.C4)(["input big",{error:!p.value&&v.value,success:p.value&&v.value}]),"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),placeholder:e.$t("message.create_pin_wallet_name_placeholder"),onInput:X},null,42,I),[[i.Jo,o.value]])])]),(0,a.Lk)("div",B,[(0,a.Lk)("div",D,(0,s.v_)(e.$t("message.create_pin_create_pin_label")),1),(0,a.Lk)("div",j,[(0,a.Lk)("div",x,[(0,a.bo)((0,a.Lk)("input",{type:"password",class:"input big","onUpdate:modelValue":t[1]||(t[1]=e=>b.value[0]=e),maxlength:"1",inputmode:"numeric",onInput:t[2]||(t[2]=e=>z(e,1)),onKeydown:t[3]||(t[3]=(0,i.jR)((e=>G(e,0)),["backspace"]))},null,544),[[i.Jo,b.value[0]]])]),(0,a.Lk)("div",K,[(0,a.bo)((0,a.Lk)("input",{type:"password",class:"input big","onUpdate:modelValue":t[4]||(t[4]=e=>b.value[1]=e),maxlength:"1",inputmode:"numeric",disabled:!b.value[0].length,onInput:t[5]||(t[5]=e=>z(e,2)),onKeydown:t[6]||(t[6]=(0,i.jR)((e=>G(e,1)),["backspace"]))},null,40,E),[[i.Jo,b.value[1]]])]),(0,a.Lk)("div",C,[(0,a.bo)((0,a.Lk)("input",{type:"password",class:"input big","onUpdate:modelValue":t[7]||(t[7]=e=>b.value[2]=e),maxlength:"1",inputmode:"numeric",disabled:!b.value[1].length,onInput:t[8]||(t[8]=e=>z(e,3)),onKeydown:t[9]||(t[9]=(0,i.jR)((e=>G(e,2)),["backspace"]))},null,40,R),[[i.Jo,b.value[2]]])]),(0,a.Lk)("div",V,[(0,a.bo)((0,a.Lk)("input",{type:"password",class:"input big","onUpdate:modelValue":t[10]||(t[10]=e=>b.value[3]=e),maxlength:"1",inputmode:"numeric",disabled:!b.value[2].length,onInput:t[11]||(t[11]=e=>z(e,4)),onKeydown:t[12]||(t[12]=(0,i.jR)((e=>G(e,3)),["backspace"]))},null,40,A),[[i.Jo,b.value[3]]])])])]),(0,a.Lk)("div",S,[(0,a.Lk)("div",W,(0,s.v_)(e.$t("message.create_pin_confirm_pin_label")),1),(0,a.Lk)("div",{class:(0,s.C4)(["row",{error:Q.value[3].length&&!H.value,success:Q.value[3].length&&H.value}])},[(0,a.Lk)("div",$,[(0,a.bo)((0,a.Lk)("input",{type:"password",class:"input big","onUpdate:modelValue":t[13]||(t[13]=e=>Q.value[0]=e),maxlength:"1",inputmode:"numeric",disabled:!b.value[3].length,onInput:t[14]||(t[14]=e=>z(e,1)),onKeydown:t[15]||(t[15]=(0,i.jR)((e=>G(e,0)),["backspace"]))},null,40,M),[[i.Jo,Q.value[0]]])]),(0,a.Lk)("div",J,[(0,a.bo)((0,a.Lk)("input",{type:"password",class:"input big","onUpdate:modelValue":t[16]||(t[16]=e=>Q.value[1]=e),maxlength:"1",inputmode:"numeric",disabled:!Q.value[0].length,onInput:t[17]||(t[17]=e=>z(e,2)),onKeydown:t[18]||(t[18]=(0,i.jR)((e=>G(e,1)),["backspace"]))},null,40,P),[[i.Jo,Q.value[1]]])]),(0,a.Lk)("div",T,[(0,a.bo)((0,a.Lk)("input",{type:"password",class:"input big","onUpdate:modelValue":t[19]||(t[19]=e=>Q.value[2]=e),maxlength:"1",inputmode:"numeric",disabled:!Q.value[1].length,onInput:t[20]||(t[20]=e=>z(e,3)),onKeydown:t[21]||(t[21]=(0,i.jR)((e=>G(e,2)),["backspace"]))},null,40,U),[[i.Jo,Q.value[2]]])]),(0,a.Lk)("div",O,[(0,a.bo)((0,a.Lk)("input",{type:"password",class:"input big","onUpdate:modelValue":t[22]||(t[22]=e=>Q.value[3]=e),maxlength:"1",inputmode:"numeric",disabled:!Q.value[2].length,onInput:t[23]||(t[23]=e=>z(e,4)),onKeydown:t[24]||(t[24]=(0,i.jR)((e=>G(e,3)),["backspace"]))},null,40,q),[[i.Jo,Q.value[3]]])])],2)]),(0,a.Lk)("button",{class:(0,s.C4)(["biometric_btn",{disabled:!Y.value}]),onClick:(0,i.D$)(Z,["prevent"])},[F,(0,a.Lk)("span",null,(0,s.v_)(e.$t("message.btn_biometric")),1)],2),(0,a.Lk)("div",N,[(0,a.Lk)("button",{class:(0,s.C4)(["btn",{disabled:!Y.value}]),onClick:(0,i.D$)(ee,["prevent"])},[(0,a.Lk)("span",null,(0,s.v_)(e.$t("message.btn_next")),1)],2)])],64))])])])])}}},X=n(1241);const z=(0,X.A)(Q,[["__scopeId","data-v-16c899dc"]]);var G=z}}]);
//# sourceMappingURL=234.07766e1c.js.map